# 캠페인 등록 수동 테스트 가이드

## 준비사항

1. **개발 서버 실행**
   ```bash
   npm run dev
   ```

2. **데이터베이스 확인**
   ```bash
   npx prisma studio
   ```

3. **테스트 이미지 생성**
   ```bash
   node test/images/create-test-images.js
   ```

## 테스트 단계

### 1단계: 비즈니스 계정 로그인

1. 브라우저에서 `http://localhost:3000/login` 접속
2. 비즈니스 계정으로 로그인
3. 로그인 성공 시 대시보드로 이동 확인

### 2단계: 새 캠페인 생성 페이지 접속

1. `http://localhost:3000/business/campaigns/new` 접속
2. 캠페인 생성 폼이 정상 로드되는지 확인

### 3단계: 이미지 업로드 테스트

**테스트할 이미지들:**
- `test/images/header.svg` (헤더 이미지)
- `test/images/thumbnail.svg` (썸네일 이미지)  
- `test/images/product1.svg`, `product2.svg`, `product3.svg` (상품 이미지)

**확인사항:**
- [x] 파일 선택 후 업로드 버튼 클릭
- [x] "업로드 중..." 상태 표시
- [x] 업로드 완료 후 미리보기 표시
- [x] 이미지 삭제 기능 (X 버튼)
- [x] 잘못된 파일 형식 업로드 시 에러 메시지
- [x] 15MB 초과 파일 업로드 시 에러 메시지

### 4단계: 캠페인 정보 입력

**기본 정보:**
- 제목: "2024 겨울 스킨케어 신제품 체험단"
- 설명: "새로운 비타민C 세럼을 체험하고 솔직한 리뷰를 남겨주세요"
- 플랫폼: Instagram 선택

**상세 정보:**
- 예산: 1,000,000원
- 목표 팔로워수: 10,000명
- 최대 지원자 수: 50명
- 시작일: 오늘 + 7일
- 종료일: 시작일 + 30일
- 발표일: 시작일 - 2일
- 요구사항: "스킨케어에 관심이 많은 20-30대 여성"
- 해시태그: "#비타민C세럼 #스킨케어 #신제품체험"

**확인사항:**
- [x] 필수 필드 누락 시 에러 메시지
- [x] 날짜 유효성 검증 (시작일 < 오늘, 종료일 < 시작일, 발표일 > 시작일)
- [x] 각 필드별 입력 제한 확인

### 5단계: 결제 테스트

#### 5-1. 계좌이체 결제 테스트

1. "계좌이체" 선택
2. "결제하기" 버튼 클릭
3. 즉시 결제 완료 처리 확인
4. 캠페인 상태가 "ACTIVE"로 변경 확인
5. `isPaid`가 `true`로 변경 확인

#### 5-2. 카드 결제 테스트 (선택사항)

1. "신용카드" 선택
2. "결제하기" 버튼 클릭
3. 토스페이먼츠 결제창 팝업 확인
4. 테스트 카드 정보 입력:
   - 카드번호: 4242424242424242
   - 유효기간: 12/25
   - CVC: 123
5. 결제 완료 후 콜백 처리 확인

### 6단계: 결과 확인

1. **캠페인 생성 확인**
   - 캠페인 ID 생성 확인
   - 데이터베이스 `campaigns` 테이블 확인

2. **결제 정보 확인**
   - 데이터베이스 `payments` 테이블 확인
   - 결제 상태 'COMPLETED' 확인

3. **수수료 기록 확인**
   - 데이터베이스 `revenue` 테이블 확인
   - 플랫폼 수수료 10% 기록 확인

4. **파일 업로드 확인**
   - `/public/uploads/campaign/` 폴더에 이미지 파일 저장 확인
   - 리사이징된 이미지 확인 (campaign 이미지는 1200px 너비)

5. **대시보드 확인**
   - 비즈니스 대시보드에서 생성된 캠페인 확인
   - 캠페인 상태 "진행중" 표시 확인

## 오류 케이스 테스트

### 인증 오류
- [x] 로그인하지 않은 상태에서 API 호출 시 401 에러
- [x] 잘못된 토큰으로 API 호출 시 401 에러
- [x] 인플루언서 계정으로 비즈니스 API 호출 시 403 에러

### 업로드 오류
- [x] 지원하지 않는 파일 형식 (.txt, .exe 등)
- [x] 15MB 초과 파일
- [x] 빈 파일 또는 손상된 파일

### 데이터 검증 오류
- [x] 필수 필드 누락
- [x] 잘못된 날짜 값
- [x] 음수 예산 또는 팔로워수
- [x] 잘못된 플랫폼 값

### 결제 오류
- [x] 결제 취소 시 캠페인 DRAFT 상태 유지
- [x] 결제 실패 시 에러 메시지 표시
- [x] 중복 결제 방지

## 성능 테스트

- [x] 대용량 이미지 업로드 시간 측정
- [x] 동시 여러 사용자 캠페인 생성 테스트
- [x] API 응답 시간 측정 (< 2초 목표)

## 브라우저 호환성

- [x] Chrome (최신 버전)
- [x] Safari (최신 버전) 
- [x] Firefox (최신 버전)
- [x] 모바일 Safari
- [x] 모바일 Chrome

## 자동화 테스트 실행

인증 토큰을 얻은 후 자동화 테스트 실행:

```bash
# 1. 토큰 가져오기
node scripts/get-auth-token.js

# 2. 환경 변수 설정 후 테스트 실행
AUTH_TOKEN="your-token-here" USER_ID="your-user-id" node scripts/test-campaign-creation.js
```

## 문제 해결

### 서버 연결 오류
```bash
# 서버 재시작
npm run dev

# 포트 확인
lsof -i :3000
```

### 데이터베이스 오류
```bash
# Prisma 스키마 재생성
npx prisma generate

# 데이터베이스 재설정
npx prisma db push
```

### 업로드 폴더 권한 오류
```bash
# 업로드 폴더 생성 및 권한 설정
mkdir -p public/uploads/campaign
chmod 755 public/uploads/campaign
```